<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Contracts · FinanceModels.jl</title><meta name="title" content="Contracts · FinanceModels.jl"/><meta property="og:title" content="Contracts · FinanceModels.jl"/><meta property="twitter:title" content="Contracts · FinanceModels.jl"/><meta name="description" content="Documentation for FinanceModels.jl."/><meta property="og:description" content="Documentation for FinanceModels.jl."/><meta property="twitter:description" content="Documentation for FinanceModels.jl."/><meta property="og:url" content="https://JuliaActuary.github.io/FinanceModels.jl/contracts/"/><meta property="twitter:url" content="https://JuliaActuary.github.io/FinanceModels.jl/contracts/"/><link rel="canonical" href="https://JuliaActuary.github.io/FinanceModels.jl/contracts/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="FinanceModels.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">FinanceModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Guide</span><ul><li><a class="tocitem" href="../introduction/">Introduction</a></li><li><a class="tocitem" href="../models/">Models, Valuation, and Fitting</a></li><li class="is-active"><a class="tocitem" href>Contracts</a><ul class="internal"><li><a class="tocitem" href="#**Contracts**-A-composable-way-to-represent-financial-instruments"><span><strong>Contracts</strong> - A composable way to represent financial instruments</span></a></li><li><a class="tocitem" href="#Cashflow-a-fundamental-financial-type"><span><code>Cashflow</code> - a fundamental financial type</span></a></li><li><a class="tocitem" href="#Available-Contracts-and-Modules"><span>Available Contracts &amp; Modules</span></a></li></ul></li><li><a class="tocitem" href="../Rates/">Rates</a></li><li><a class="tocitem" href="../migration/">Migration Guide</a></li></ul></li><li><span class="tocitem">Modules</span><ul><li><a class="tocitem" href="../API/FinanceModels/">FinanceModels</a></li><li><a class="tocitem" href="../API/FinanceCore/">FinanceCore</a></li><li><a class="tocitem" href="../API/Spline/">Spline</a></li><li><a class="tocitem" href="../API/Fit/">Fit</a></li><li><a class="tocitem" href="../API/Yield/">Yield</a></li><li><a class="tocitem" href="../API/Bond/">Bond</a></li><li><a class="tocitem" href="../API/Equity/">Equity</a></li><li><a class="tocitem" href="../API/Option/">Option</a></li><li><a class="tocitem" href="../API/Volatility/">Volatility</a></li></ul></li><li><a class="tocitem" href="../faq/">FAQs</a></li><li><a class="tocitem" href="../extensions/">Extensions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guide</a></li><li class="is-active"><a href>Contracts</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Contracts</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaActuary/FinanceModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaActuary/FinanceModels.jl/blob/master/docs/src/contracts.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Contracts"><a class="docs-heading-anchor" href="#Contracts">Contracts</a><a id="Contracts-1"></a><a class="docs-heading-anchor-permalink" href="#Contracts" title="Permalink"></a></h1><h2 id="**Contracts**-A-composable-way-to-represent-financial-instruments"><a class="docs-heading-anchor" href="#**Contracts**-A-composable-way-to-represent-financial-instruments"><strong>Contracts</strong> - A composable way to represent financial instruments</a><a id="**Contracts**-A-composable-way-to-represent-financial-instruments-1"></a><a class="docs-heading-anchor-permalink" href="#**Contracts**-A-composable-way-to-represent-financial-instruments" title="Permalink"></a></h2><p>Contracts are a composable way to represent financial instruments. They are, in essence, anything that is a collection of cashflows. Contracts can be combined to represent more complex instruments. For example, a bond can be represented as a collection of cashflows that correspond to the coupon payments and the principal repayment.</p><p>Examples:</p><ul><li>a <code>Cashflow</code></li><li><code>Bond</code>s:<ul><li><code>Bond.Fixed</code>, <code>Bond.Floating</code></li></ul></li><li><code>Option</code>s:</li><li><code>Option.EuroCall</code> and <code>Option.EuroPut</code> </li><li>Compositional contracts:<ul><li><code>Forward</code>to represent an instrument that is relative to a forward point in time.</li><li><code>Composite</code> to represent the combination of two other instruments.  </li></ul></li></ul><p>In the future, this notion may be extended to liabilities (e.g. insurance policies in LifeContingencies.jl)</p><h2 id="Cashflow-a-fundamental-financial-type"><a class="docs-heading-anchor" href="#Cashflow-a-fundamental-financial-type"><code>Cashflow</code> - a fundamental financial type</a><a id="Cashflow-a-fundamental-financial-type-1"></a><a class="docs-heading-anchor-permalink" href="#Cashflow-a-fundamental-financial-type" title="Permalink"></a></h2><p>Say you wanted to model a contract that paid quarterly payments, and those payments occurred starting 15 days from the valuation date (first payment time = 15/365 = 0.057)</p><p>Previously, you had two options:</p><ul><li>Choose a discrete timestep to model (e.g. monthly, quarterly, annual) and then lump the cashflows into those timesteps. E.g. with monthly timesteps  of a unit payment of our contract, it might look like: <code>[1,0,0,1,0,0...]</code></li><li>Keep track of two vectors: one for the payment and one for the times. In this case, that might look like: <code>cfs = [1,1,...];</code>times = <code>[0.057, 0.307...]</code></li></ul><p>The former has inaccuracies due to the simplified timing and logical complication related to mapping the contracts natural periodicity into an arbitrary modeling choice. The latter becomes unwieldy and fails to take advantage of Julia&#39;s type system. </p><p>The new solution: <code>Cashflow</code>s. Our example above would become: <code>[Cashflow(1,0.057), Cashflow(1,0.307),...]</code></p><h3 id="Creating-a-new-Contract"><a class="docs-heading-anchor" href="#Creating-a-new-Contract">Creating a new Contract</a><a id="Creating-a-new-Contract-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-a-new-Contract" title="Permalink"></a></h3><p>A contract is anything that creates a vector of <code>Cashflow</code>s when <code>collect</code>ed. For example, let&#39;s create a bond which only pays down principle and offers no coupons.</p><pre><code class="language-julia hljs">using FinanceModels,FinanceCore

# Transducers is used to provide a more powerful, composible way to construct collections than the basic iteration interface
using Transducers: __foldl__, @next, complete

&quot;&quot;&quot;
A bond which pays down its par (one unit) in equal payments. 
&quot;&quot;&quot;
struct PrincipleOnlyBond{F&lt;:FinanceCore.Frequency} &lt;: FinanceModels.Bond.AbstractBond
    frequency::F
    maturity::Float64
end

# We extend the interface to say what should happen as the bond is projected
# There&#39;s two parts to customize:
# 1. any initialization or state to keep track of
# 2. The loop where we decide what gets returned at each timestep
function Transducers.__foldl__(rf, val, p::Projection{C,M,K}) where {C&lt;:PrincipleOnlyBond,M,K}
    # initialization stuff
    b = p.contract # the contract within a projection
    ts = Bond.coupon_times(b) # works since it&#39;s a FinanceModels.Bond.AbstractBond with a frequency and maturity
    pmt = 1 / length(ts)

    for t in ts
        # the loop wich returns a value
        cf = Cashflow(pmt, t)
        val = @next(rf, val, cf) # the value to return is the last argument
    end
    return complete(rf, val)
end</code></pre><p>That&#39;s it! then we can use this fitting models, projections, quotes, etc. Here we simply collect the bond into an array of cashflows:</p><pre><code class="language-julia-repl hljs">julia&gt; PrincipleOnlyBond(Periodic(2),5.) |&gt; collect
10-element Vector{Cashflow{Float64, Float64}}:
 Cashflow{Float64, Float64}(0.1, 0.5)
 Cashflow{Float64, Float64}(0.1, 1.0)
 Cashflow{Float64, Float64}(0.1, 1.5)
 Cashflow{Float64, Float64}(0.1, 2.0)
 Cashflow{Float64, Float64}(0.1, 2.5)
 Cashflow{Float64, Float64}(0.1, 3.0)
 Cashflow{Float64, Float64}(0.1, 3.5)
 Cashflow{Float64, Float64}(0.1, 4.0)
 Cashflow{Float64, Float64}(0.1, 4.5)
 Cashflow{Float64, Float64}(0.1, 5.0)</code></pre><p>Note that all contracts in FinanceModels.jl are currently <em>unit</em> contracts in that they assume a unit par value. </p><h4 id="More-complex-Contracts"><a class="docs-heading-anchor" href="#More-complex-Contracts">More complex Contracts</a><a id="More-complex-Contracts-1"></a><a class="docs-heading-anchor-permalink" href="#More-complex-Contracts" title="Permalink"></a></h4><h5 id="Sets-of-contracts"><a class="docs-heading-anchor" href="#Sets-of-contracts">Sets of contracts</a><a id="Sets-of-contracts-1"></a><a class="docs-heading-anchor-permalink" href="#Sets-of-contracts" title="Permalink"></a></h5><p>Sets of contracts can be put in an <code>AbstractArray</code> contained (e.g. a <code>Vector</code>) and then handled together. For example, we combine two bonds as a portfolio to project together:</p><pre><code class="language-julia-repl hljs">julia&gt; c1 = Bond.Fixed(0.05, Periodic(1), 2.0);
julia&gt; c2 = Bond.Fixed(0.04, Periodic(1), 2.0);

julia&gt; Projection([c1, c2]) |&gt; collect
4-element Vector{Cashflow{Float64, Float64}}:
 Cashflow{Float64, Float64}(0.05, 1.0)
 Cashflow{Float64, Float64}(1.05, 2.0)
 Cashflow{Float64, Float64}(0.04, 1.0)
 Cashflow{Float64, Float64}(1.04, 2.0)</code></pre><h5 id="Transformations"><a class="docs-heading-anchor" href="#Transformations">Transformations</a><a id="Transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Transformations" title="Permalink"></a></h5><p>Contracts (<code>&lt;:AbstractContract</code>) and <a href="../API/FinanceModels/#FinanceModels.Projection"><code>Projection</code></a>s can be modified to be scaled or transformed using the transformations in <a href="https://juliafolds2.github.io/Transducers.jl/stable/#List-of-transducers">Transducers.jl</a> after importing that package.</p><p>Most commonly, this is likely simply chaining <code>Map(...)</code> calls. Two use-cases of this may be to (1) scale the contract by a factor or (2) change the sign of the contract to indicate an obligation/liability instead of an asset. Examples of this:</p><pre><code class="language-julia-repl hljs">julia&gt; using Transducers, FinanceModels

julia&gt; Bond.Fixed(0.05,Periodic(1),3) |&gt; collect
3-element Vector{Cashflow{Float64, Float64}}:
 Cashflow{Float64, Float64}(0.05, 1.0)
 Cashflow{Float64, Float64}(0.05, 2.0)
 Cashflow{Float64, Float64}(1.05, 3.0)

julia&gt; Bond.Fixed(0.05,Periodic(1),3) |&gt; Map(-) |&gt; collect
3-element Vector{Cashflow{Float64, Float64}}:
 Cashflow{Float64, Float64}(-0.05, 1.0)
 Cashflow{Float64, Float64}(-0.05, 2.0)
 Cashflow{Float64, Float64}(-1.05, 3.0)

julia&gt; Bond.Fixed(0.05,Periodic(1),3) |&gt; Map(-) |&gt; Map(x-&gt;x*2) |&gt; collect
3-element Vector{Cashflow{Float64, Float64}}:
 Cashflow{Float64, Float64}(-0.1, 1.0)
 Cashflow{Float64, Float64}(-0.1, 2.0)
 Cashflow{Float64, Float64}(-2.1, 3.0)</code></pre><p>Another example of this is how <code>InterestRateSwap</code>[@ref] is implemented. It&#39;s simply a <code>Composite</code> contract of a positive fixed rate bond and a negative floating rate bond:</p><pre><code class="language-julia hljs">function InterestRateSwap(curve, tenor; model_key=&quot;OIS&quot;)
    fixed_rate = par(curve, tenor; frequency=4)
    fixed_leg = Bond.Fixed(rate(fixed_rate), Periodic(4), tenor)
    float_leg = Bond.Floating(0.0, Periodic(4), tenor, model_key) |&gt; Map(-)
    return Composite(fixed_leg, float_leg)
end</code></pre><h5 id="Cashflows-are-model-dependent"><a class="docs-heading-anchor" href="#Cashflows-are-model-dependent">Cashflows are model dependent</a><a id="Cashflows-are-model-dependent-1"></a><a class="docs-heading-anchor-permalink" href="#Cashflows-are-model-dependent" title="Permalink"></a></h5><p>An example of this is a floating bond where the coupon paid depends on a view of forward rates. See <a href="../introduction/#Contracts-that-depend-on-the-model-(or-multiple-models)">this section in the overview</a> on projections for how this is handled.</p><h2 id="Available-Contracts-and-Modules"><a class="docs-heading-anchor" href="#Available-Contracts-and-Modules">Available Contracts &amp; Modules</a><a id="Available-Contracts-and-Modules-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Contracts-and-Modules" title="Permalink"></a></h2><p>See the Modules in the left navigation for details on available contracts/models/functions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../models/">« Models, Valuation, and Fitting</a><a class="docs-footer-nextpage" href="../Rates/">Rates »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 4 August 2025 16:00">Monday 4 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
